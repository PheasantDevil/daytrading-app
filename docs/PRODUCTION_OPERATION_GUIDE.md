# 実運用ガイド（オプションC: データ収集フェーズ）

## 📋 目的

1-2週間の実運用を通じて取引データを蓄積し、システムの動作を確認します。

---

## 🎯 このフェーズの目標

### データ収集
- ✅ 最低10-20取引のデータを蓄積
- ✅ 勝率、損益、シグナル精度を記録
- ✅ システムの問題点を発見
- ✅ 最適な設定値を見つける

### 期間
- **推奨**: 1-2週間（営業日10-14日）
- **最低**: 10取引（約2週間）

---

## 📅 運用スケジュール

### 毎日のルーティン

```
【朝】08:00-09:00
- システムの起動確認
- 前日のレポート確認
- 設定の確認

【昼前】10:45-11:15
- システムが購入フェーズを実行（11:00）
- 購入結果の確認
- ポジション確認

【昼過ぎ】13:00-15:30
- システムが売却監視を開始（13:00）
- リアルタイムで損益確認
- 売却結果の確認
- 強制決済の確認（15:00）

【夕方】16:00-17:00
- デイリーレポートの確認
- データの記録
- 翌日の準備
```

---

## 🚀 実運用の開始方法

### Step 1: 初期設定の確認

```bash
# 1. 設定ファイルの確認
cat src/config/day-trading-config.ts

# 確認項目:
# - trading.enabled = false （初回は無効で確認のみ）
# - trading.paperTrading = true （ペーパートレーディング）
# - trading.confirmBeforeTrade = true （取引前確認）
```

### Step 2: 初回テスト実行

```bash
# ドライラン（取引しない）
npm run practice:day-trading

# 確認項目:
# - エラーが出ないか
# - 候補銘柄が選定されるか
# - シグナルが集約されるか
# - レポートが生成されるか
```

### Step 3: 自動取引を有効化（準備ができたら）

設定ファイルを編集:
```typescript
// src/config/day-trading-config.ts

export const myDayTradingConfig: DayTradingConfig = {
  ...defaultDayTradingConfig,
  trading: {
    enabled: true,              // 自動取引有効化
    paperTrading: true,         // まずはペーパートレーディング
    confirmBeforeTrade: false,  // 確認なしで自動実行
    maxRetries: 3,
  },
};
```

### Step 4: スケジューラーの起動

```bash
# バックグラウンドで実行
npm run trade:auto-start &

# または
# スクリーンセッションで実行
screen -S daytrading
npm run trade:auto-start
# Ctrl+A, D でデタッチ
```

---

## 📊 データ収集項目

### 毎日記録すべきデータ

**1. 取引データ**
- 日付
- 候補銘柄（スクリーニング結果）
- 選択された銘柄
- 購入価格
- 売却価格
- 売却理由（目標達成/ストップロス/強制決済）
- 損益率
- 損益額

**2. シグナルデータ**
- 各サイトのシグナル（BUY/HOLD/SELL）
- 確信度
- 過半数判定結果

**3. パフォーマンスデータ**
- 勝率
- 平均利益
- 平均損失
- 最大ドローダウン
- シャープレシオ

---

## 📝 データ記録テンプレート

### エクセル/スプレッドシート

| 日付 | 候補銘柄 | 選択銘柄 | BUYシグナル | 購入価格 | 売却価格 | 売却理由 | 損益率 | 損益額 | メモ |
|------|---------|---------|-----------|---------|---------|---------|-------|-------|------|
| 10/10 | AAPL,GOOGL,MSFT | - | 0/7 | - | - | 購入なし | 0% | $0 | 全てHOLD |
| 10/11 | AAPL,TSLA,NVDA | AAPL | 1/7 | $175.50 | $184.27 | 目標達成 | +5.0% | $438.50 | 順調 |

### JSON形式（自動記録）

```json
{
  "date": "2025-10-10",
  "candidates": ["AAPL", "GOOGL", "MSFT", "TSLA", "AMZN", "META", "NVDA"],
  "selected": null,
  "buySignals": {
    "AAPL": { "buy": 0, "hold": 1, "sell": 0 },
    "GOOGL": { "buy": 0, "hold": 1, "sell": 0 }
  },
  "trade": null,
  "result": "no_trade"
}
```

---

## 🔍 毎日の確認項目

### 朝のチェックリスト

- [ ] システムが起動しているか
- [ ] 前日のレポートを確認
- [ ] エラーログを確認
- [ ] 設定が正しいか
- [ ] 市場が開いているか（休場日でないか）

### 購入後のチェックリスト（11:00-11:30）

- [ ] 購入が実行されたか
- [ ] 購入銘柄が妥当か
- [ ] 購入価格が適正か
- [ ] ポジションサイズが適切か
- [ ] シグナル集約結果を確認

### 売却後のチェックリスト（13:00-15:30）

- [ ] 売却が実行されたか
- [ ] 売却理由を確認
- [ ] 損益を記録
- [ ] 目標達成率を確認
- [ ] 問題がなかったか

### 夕方のチェックリスト（16:00-17:00）

- [ ] デイリーレポートを確認
- [ ] データを記録
- [ ] 今日の学びをメモ
- [ ] 翌日の準備
- [ ] システムが正常に停止したか

---

## 📈 週次レビュー

### 毎週金曜日（または週末）

**1. 週次データの集計**
```
今週の取引:
- 取引日数: 5日
- 実取引数: 3回
- 勝ち: 2回
- 負け: 1回
- 勝率: 66.7%
- 総損益: +$523
- 平均損益: +$174.33
```

**2. パターンの分析**
- どの銘柄が多く選ばれたか
- どの時間帯で売却が多いか
- ストップロスが多いか、目標達成が多いか
- シグナルの精度はどうか

**3. 問題点の洗い出し**
- エラーが発生したか
- 予期しない動作はあったか
- 改善すべき点は何か

**4. 設定の見直し**
- ストップロス/テイクプロフィットの調整
- スクリーニング条件の調整
- シグナル閾値の調整

---

## 🎯 1-2週間後の評価項目

### データ十分性チェック

- [ ] 最低10取引以上のデータがある
- [ ] 勝ち・負けの両方のケースがある
- [ ] 複数の銘柄で取引している
- [ ] 様々な市場状況を経験している

### システム安定性チェック

- [ ] エラーなく動作している
- [ ] 購入・売却が正常に実行されている
- [ ] レポートが正確に生成されている
- [ ] リスク管理が機能している

### パフォーマンスチェック

- [ ] 勝率が50%以上（理想）
- [ ] 平均利益 > 平均損失
- [ ] 最大ドローダウンが許容範囲内
- [ ] 総損益がプラス（理想）

---

## 📊 データ分析の観点

### 1. シグナル精度

**質問**:
- Yahoo Financeのシグナルは信頼できるか？
- BUYシグナルの銘柄は実際に上昇したか？
- HOLDと判定された銘柄は見送って正解だったか？

**分析方法**:
```
BUYシグナル精度 = (実際に上昇した回数) / (BUY判定回数)
目標: 60%以上
```

### 2. リスク管理の有効性

**質問**:
- ストップロス（-3%）は適切か？
- テイクプロフィット（+5%）は達成可能か？
- 強制決済で損失が拡大していないか？

**分析方法**:
```
ストップロス発動率 = (ストップロス回数) / (総取引数)
理想: 30%以下
```

### 3. 銘柄選定の妥当性

**質問**:
- スクリーニング条件は適切か？
- 選ばれる銘柄に偏りはないか？
- 流動性は十分か？

**分析方法**:
```
銘柄分布を確認
出来高を確認
```

---

## 🛠️ トラブルシューティング

### 問題1: 購入推奨銘柄が出ない

**原因**:
- 市場全体が下落トレンド
- Yahoo Financeのシグナルが保守的すぎる

**対策**:
```typescript
// シグナル判定を緩和
// yahoo-finance-signal.ts の分析ロジックを調整
if (buyScore > sellScore) {  // +1 を削除
  signal = 'BUY';
}
```

### 問題2: ストップロスが頻繁に発動

**原因**:
- ストップロス（-3%）が厳しすぎる
- ボラティリティが高い銘柄を選んでいる

**対策**:
```typescript
// ストップロスを緩和
riskManagement: {
  stopLoss: -0.05,  // -5%に変更
}
```

### 問題3: 目標利益に到達しない

**原因**:
- テイクプロフィット（+5%）が高すぎる
- 日中の値動きが小さい

**対策**:
```typescript
// 目標を下げる
riskManagement: {
  takeProfit: 0.03,  // +3%に変更
}
```

---

## 📧 レポートの活用

### デイリーレポート

**確認項目**:
- 今日の取引があったか
- 損益はどうだったか
- 理由は妥当か

**アクション**:
- データを記録
- 問題があれば設定調整

### 週次レポート（自分で作成）

**テンプレート**:
```
========== 週次レポート ==========
期間: 2025/10/7 - 2025/10/11

【週次統計】
取引日数: 5日
実取引数: 3回
勝ち: 2回
負け: 1回
勝率: 66.7%
総損益: +$523.00

【取引詳細】
1. 10/8: AAPL BUY→SELL (+5.2%, +$260)
2. 10/10: GOOGL BUY→SELL (+4.8%, +$288)
3. 10/11: MSFT BUY→SELL (-3.0%, -$25, ストップロス)

【学び】
- AAPLとGOOGLは好調
- MSFTはストップロス
- 勝率は目標を上回る

【次週の改善点】
- スクリーニングでMSFTを除外してみる
- 様子を見る
========================================
```

---

## 🔧 設定の調整方法

### 1. より積極的な設定（リスク高・リターン高）

```typescript
export const aggressiveDayTradingConfig: DayTradingConfig = {
  ...defaultDayTradingConfig,
  
  riskManagement: {
    stopLoss: -0.05,           // -5%（緩い）
    takeProfit: 0.03,          // +3%（早めに利確）
    maxPositionSize: 15000,    // $15,000（大きい）
    maxDailyTrades: 2,         // 1日2取引まで
    emergencyStopLoss: -0.08,  // -8%
  },
  
  screening: {
    minVolume: 500000,         // 50万株（緩い）
    minPrice: 5,               // $5（低価格株も対象）
    maxPrice: 1000,            // $1,000（高価格株も対象）
    candidateCount: 20,        // 20銘柄（多め）
  },
};
```

### 2. より保守的な設定（リスク低・安定志向）

```typescript
export const conservativeDayTradingConfig: DayTradingConfig = {
  ...defaultDayTradingConfig,
  
  riskManagement: {
    stopLoss: -0.02,           // -2%（厳しい）
    takeProfit: 0.07,          // +7%（慎重）
    maxPositionSize: 5000,     // $5,000（小さい）
    maxDailyTrades: 1,         // 1日1取引
    emergencyStopLoss: -0.03,  // -3%
  },
  
  screening: {
    minVolume: 2000000,        // 200万株（厳しい）
    minPrice: 50,              // $50（安定株のみ）
    maxPrice: 300,             // $300（高すぎる株は除外）
    candidateCount: 5,         // 5銘柄（少なめ）
  },
};
```

---

## 📈 期待される結果

### 理想的なケース（1週間）

```
取引日数: 5日
実取引数: 4回（80%の確率で取引発生）
勝ち: 3回
負け: 1回
勝率: 75%
平均利益: +5.0%
平均損失: -3.0%
総損益: +$800

評価: ✅ 優秀
```

### 現実的なケース（1週間）

```
取引日数: 5日
実取引数: 3回（60%の確率で取引発生）
勝ち: 2回
負け: 1回
勝率: 66.7%
平均利益: +5.0%
平均損失: -3.0%
総損益: +$400

評価: ✅ 良好
```

### 要改善ケース（1週間）

```
取引日数: 5日
実取引数: 5回（毎日取引）
勝ち: 2回
負け: 3回
勝率: 40%
平均利益: +5.0%
平均損失: -3.0%
総損益: -$100

評価: ⚠️ 設定要調整
```

---

## 🚨 運用中の注意事項

### やるべきこと

1. **毎日の確認**
   - 朝: システム起動確認
   - 昼: 取引実行確認
   - 夕: レポート確認

2. **データ記録**
   - デイリーレポートを保存
   - スプレッドシートに記録
   - パターンをメモ

3. **定期的な見直し**
   - 週1回: 設定の見直し
   - 2週間後: 総合評価

### やってはいけないこと

1. **❌ 途中で設定を頻繁に変更**
   - 最低1週間は同じ設定で運用
   - データが蓄積されないと評価できない

2. **❌ 手動介入**
   - システムを信頼する
   - 自動判定に任せる

3. **❌ 感情的な判断**
   - 1-2回の損失で設定を変えない
   - データに基づいて判断

---

## 📊 1-2週間後の判断基準

### ✅ Phase4へ進むべき（リスク管理強化）

**条件**:
- 勝率が40%以下
- ストップロスが頻発（50%以上）
- ドローダウンが大きい

**理由**: リスク管理の強化が必要

---

### ✅ Phase5へ進むべき（パフォーマンス分析）

**条件**:
- 勝率が50%以上
- 安定して利益が出ている
- より詳細な分析が必要

**理由**: パフォーマンスの最適化が必要

---

### ✅ 設定調整のみで継続

**条件**:
- 勝率が40-50%
- 時々利益が出る
- システムは正常動作

**理由**: 設定の微調整で改善可能

---

### ⚠️ 戦略の見直しが必要

**条件**:
- 勝率が30%以下
- 連続で損失
- システムの問題が頻発

**理由**: 戦略自体の見直しが必要

---

## 💡 成功のヒント

### 1. 焦らない
- 最初の1週間は学習期間
- データ収集が目的
- 損益よりもデータが重要

### 2. 記録を続ける
- 毎日の記録が重要
- パターンが見えてくる
- 改善のヒントが得られる

### 3. システムを信頼する
- 過半数判定を信頼
- 感情的な判断を避ける
- データに基づいて改善

### 4. 少額から開始
- ペーパートレーディングで十分
- 実資金は少額から
- 徐々に増やす

---

## 📝 2週間後のレビューテンプレート

```
========== 2週間運用レビュー ==========

【期間】
2025/10/10 - 2025/10/24（営業日10日）

【取引統計】
候補銘柄選定日数: 10日
実取引発生日数: 7日 (70%)
総取引数: 7回
勝ち: 4回
負け: 3回
勝率: 57.1%

【損益】
総損益: +$892.00
平均利益: +$312.50 (+5.2%)
平均損失: -$108.33 (-2.8%)
最大利益: +$445.00 (+5.8%)
最大損失: -$155.00 (-3.1%)

【リスク指標】
最大ドローダウン: -8.5%
シャープレシオ: 1.23
連続勝ち: 3回
連続負け: 2回

【銘柄分布】
AAPL: 3回 (2勝1敗)
GOOGL: 2回 (1勝1敗)
MSFT: 1回 (1勝)
NVDA: 1回 (0勝1敗)

【売却理由】
目標達成: 4回 (57%)
ストップロス: 2回 (29%)
強制決済: 1回 (14%)

【問題点】
- NVDAでストップロス
- 強制決済で小さな損失

【学び】
- AAPLとGOOGLが好調
- NVDAはボラティリティが高い
- 目標達成率が高い（良い傾向）

【次のステップ】
✅ Phase5へ進む（パフォーマンス分析）
  - 詳細なレポート自動化
  - 月次分析
  - 最適化提案

========================================
```

---

## 🎉 このフェーズの成果

**2週間の実運用を通じて**:
- ✅ 実際の取引データを蓄積
- ✅ システムの安定性を確認
- ✅ 最適な設定値を発見
- ✅ 改善すべき点を明確化
- ✅ 次のPhaseへの準備完了

**データに基づいた改善ができる状態になります！** 📊

