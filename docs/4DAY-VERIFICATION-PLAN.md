# 4日間仮想自動デイトレード検証計画書

**実施期間**: 2025年10月14日（火）〜 10月17日（金）

**目的**: 今後のデイトレード自動化に向けたパラメータ最適化とバランス調整のためのデータ収集

---

## 📋 目次

1. [検証の目的](#検証の目的)
2. [事前準備](#事前準備)
3. [4日間の実行計画](#4日間の実行計画)
4. [データ収集項目](#データ収集項目)
5. [LINE通知機能](#line通知機能)
6. [実行手順](#実行手順)
7. [結果分析方法](#結果分析方法)

---

## 🎯 検証の目的

今後のデイトレード自動化において、以下のバランスを最適化するためのデータ収集を行います：

### 主要な検証項目

| 項目 | 目的 | 測定指標 |
|------|------|---------|
| **リスク管理パラメータ** | ストップロス/テイクプロフィットの最適値を見つける | 損益率、決済理由の分布 |
| **シグナル判定基準** | 過半数判定の閾値を調整する | シグナル精度、勝率 |
| **取引タイミング** | 購入・売却の最適時刻を特定する | 時刻別の損益傾向 |
| **銘柄選定基準** | スクリーニング条件の妥当性を確認する | 選定銘柄のパフォーマンス |
| **取引頻度** | 1日あたりの適切な取引数を決定する | 取引数と総損益の関係 |

---

## 🛠️ 事前準備

### 1. 必要な環境変数

```.env.local
# LINE Messaging API設定
LINE_CHANNEL_ACCESS_TOKEN=def031b6d31365406dc77b29b217daf6
LINE_USER_ID=Ua44a8b4a0828d37ff7edc22126377490
LINE_NOTIFICATION_ENABLED=true
```

### 2. インストール・設定

```bash
# 1. 依存関係のインストール（初回のみ）
npm install

# 2. LINE通知のテスト
npm run test:line

# 3. 検証準備完了の確認
npm run verify:check
```

### 3. 検証用設定パターン

#### パターン1: 保守的設定（10/14火曜日）
- **ストップロス**: -2%
- **テイクプロフィット**: +3%
- **最大ポジション**: $5,000
- **目的**: 安全性重視でベースライン確立

#### パターン2: 標準設定（10/15水曜日、10/17金曜日）
- **ストップロス**: -3%
- **テイクプロフィット**: +5%
- **最大ポジション**: $10,000
- **目的**: バランス型でデフォルト性能測定

#### パターン3: 積極的設定（10/16木曜日）
- **ストップロス**: -5%
- **テイクプロフィット**: +8%
- **最大ポジション**: $15,000
- **1日最大取引数**: 2回
- **目的**: 高リスク・高リターン戦略の検証

---

## 📅 4日間の実行計画

### 10/14（火）- Day 1: 保守的設定

**設定名**: `conservativeConfig`

**実行コマンド**:
```bash
npm run verify:trade
```

**確認項目**:
- ✅ システムが正常に起動・停止するか
- ✅ 購入・売却が予定時刻に実行されるか
- ✅ ログが正しく記録されるか
- ✅ LINE通知が正常に届くか

**期待される結果**:
- 損失を最小限に抑えた安全な取引
- システムの基本動作確認

---

### 10/15（水）- Day 2: 標準設定

**設定名**: `standardConfig`

**前日との比較点**:
- 利益率の変化（+3% → +5%）
- 損失許容度の変化（-2% → -3%）
- ポジションサイズの影響（$5K → $10K）

**分析ポイント**:
- リスク増加に対するリターンの変化
- 勝率への影響

---

### 10/16（木）- Day 3: 積極的設定

**設定名**: `aggressiveConfig`

**前日との比較点**:
- 高リスク設定の効果（SL:-5%, TP:+8%）
- 複数取引の実行可能性
- 早朝取引（09:45開始）の影響

**分析ポイント**:
- リスク許容度を上げた場合の損益
- 取引頻度を増やした場合の影響

---

### 10/17（金）- Day 4: 標準設定（再検証）

**設定名**: `standardConfig`

**目的**:
- 最も有望な設定の再現性確認
- 4日間の総合評価
- 最終推奨パラメータの決定

---

## 📊 データ収集項目

### 自動収集データ

#### 1. 取引ログ（JSON形式）
- **保存場所**: `./reports/verification-{日付}/daily-{日付}.json`
- **内容**: 
  - 候補銘柄リスト
  - 選定銘柄と選定理由
  - 売買シグナルの詳細
  - 全取引記録

#### 2. リアルタイムログ（JSONL形式）
- **保存場所**: `./reports/verification-{日付}/realtime-log.jsonl`
- **内容**: 
  - タイムスタンプ付きイベント
  - 価格更新履歴
  - システム状態の変化

#### 3. 日次レポート（テキスト形式）
- **保存場所**: `./reports/verification-{日付}/daily-report.txt`
- **内容**: 
  - 取引結果サマリー
  - 損益計算
  - 統計情報

#### 4. CSVエクスポート
- **保存場所**: `./reports/verification-{日付}/trades-export-{日付}.csv`
- **内容**: 
  - 全取引の表形式データ
  - Excel/スプレッドシートで分析可能

### 手動確認項目

**毎日16:30（取引終了後）に確認**:

```bash
# 1. 日次レポートの確認
cat ./reports/verification-$(date +%Y-%m-%d)/daily-report.txt

# 2. リアルタイムログの確認
cat ./reports/verification-$(date +%Y-%m-%d)/realtime-log.jsonl | jq '.'

# 3. 損益の記録（手動メモ推奨）
# - 購入銘柄、価格、時刻
# - 売却価格、損益率、決済理由
# - システムの挙動に関する気づき
```

---

## 📱 LINE通知機能

### 通知イベント一覧

| イベント | 通知タイミング | 通知内容 | 重要度 |
|---------|--------------|---------|--------|
| **🚀 取引開始** | システム起動時 | 日付、設定名、パラメータ | 📗 INFO |
| **📈 購入実行** | 銘柄購入時 | 銘柄、数量、価格、想定利益 | 📘 SUCCESS |
| **💰 売却実行** | 銘柄売却時 | 損益率、損益額、決済理由 | 📘 SUCCESS |
| **📊 価格変動** | ±2%以上変動時 | 現在価格、損益率 | 📗 INFO |
| **❌ エラー** | エラー発生時 | エラー内容、発生場所 | 📕 ERROR |
| **⚠️ 異常終了** | システムクラッシュ時 | 終了理由、最終状態 | 📕 ERROR |
| **📋 日次レポート** | 取引終了時 | 勝率、総損益、統計 | 📗 INFO |
| **✅ 正常終了** | 手動停止時 | 終了確認 | 📗 INFO |

### 通知メッセージ例

#### 購入実行通知
```
✅ 📈 購入実行

銘柄: AAPL
数量: 100株
価格: $150.25
投資額: $15,025.00
時刻: 11:00:15
想定利益: $751.25 (5%)
```

#### 売却実行通知（利益確定）
```
✅ 💰 売却実行（利益確定）

銘柄: AAPL
損益率: +5.23%
損益額: $785.75
売却価格: $158.11
時刻: 14:25:30
理由: テイクプロフィット
```

#### 日次レポート通知
```
🎉 📋 日次レポート

日付: 2025年10月14日
─────────────
取引数: 1回
勝率: 100.0%
総損益: $785.75
最高利益: $785.75
最大損失: $0.00
─────────────
決済理由:
・ストップロス: 0回
・テイクプロフィット: 1回
・強制決済: 0回
```

---

## 🚀 実行手順

### 毎日の実行フロー（10/14〜10/17）

#### 朝9:00頃（取引開始前）

```bash
# 1. システム起動
npm run verify:trade

# 2. LINE通知で「🚀 取引開始」を確認
# → 設定が正しく読み込まれたことを確認

# 3. ログ監視（オプション）
tail -f ./reports/verification-$(date +%Y-%m-%d)/realtime-log.jsonl
```

#### 取引時間中（自動実行）

システムが以下を自動実行：
- ✅ 11:00 - 銘柄購入
- ✅ 13:00〜 - 売却監視（1分ごと）
- ✅ 15:00 - 強制決済（必要に応じて）

LINE通知で各イベントをリアルタイム受信

#### 夕方16:30頃（取引終了後）

```bash
# 1. システム停止（Ctrl+C）
# → 自動的に日次レポートが生成される

# 2. LINE通知で「📋 日次レポート」を確認

# 3. 結果ファイルの確認
cat ./reports/verification-$(date +%Y-%m-%d)/daily-report.txt

# 4. CSVのダウンロード（オプション）
open ./reports/verification-$(date +%Y-%m-%d)/
```

---

## 📈 結果分析方法（10/17夕方以降）

### 統合分析の実行

```bash
# 4日間の結果を統合分析
npm run verify:analyze

# 統合レポートの確認
cat ./reports/verification-comprehensive-report.md
```

### 分析レポートの内容

#### 1. 日別サマリー

| 日付 | 設定 | 取引数 | 勝率 | 総損益 | 決済理由 |
|------|------|--------|------|--------|----------|
| 10/14 | 保守的 | 1 | 100% | +$525 | SL:0 TP:1 FC:0 |
| 10/15 | 標準 | 1 | 100% | +$750 | SL:0 TP:1 FC:0 |
| 10/16 | 積極的 | 2 | 50% | -$200 | SL:1 TP:1 FC:0 |
| 10/17 | 標準 | 1 | 0% | -$300 | SL:1 TP:0 FC:0 |

#### 2. 主要な発見

- **最も効果的だった設定**: 標準設定（勝率・利益率のバランス良好）
- **リスク管理の適切性**: ストップロス-3%が最適（損失を限定しつつ利益確保）
- **推奨パラメータ**: SL:-3%, TP:+5%, ポジション:$10K

#### 3. 今後の推奨事項

- 標準設定をベースに運用
- 市場ボラティリティに応じて調整
- 1日1取引に制限（リスク分散）

---

## ⚠️ 注意事項

### 必須事項

1. **仮想取引モード**: 必ず `paperTrading: true` で実行
2. **市場時間**: 米国市場の開場時間（09:30-16:00 ET）に実行
3. **システム監視**: 初日は特に注視し、異常があればすぐに停止
4. **データバックアップ**: 毎日終了後に`reports`フォルダをバックアップ

### 禁止事項

- ❌ 本番取引モードでの実行（`paperTrading: false`）
- ❌ 設定ファイルの無計画な変更
- ❌ システム実行中の強制終了（Ctrl+C以外）
- ❌ LINE通知トークンの共有・公開

---

## 📁 ファイル構成

```
daytrading-app/
├── src/
│   ├── config/
│   │   └── verification-trading-config.ts    # 検証用設定
│   └── services/
│       └── line-notification-service.ts      # LINE通知サービス
├── scripts/
│   ├── verification-trading-runner.ts        # 検証実行スクリプト
│   ├── test-line-notification.ts             # LINE接続テスト
│   └── analyze-verification-results.ts       # 結果分析スクリプト
├── reports/
│   ├── verification-2025-10-14/              # 10/14の結果
│   ├── verification-2025-10-15/              # 10/15の結果
│   ├── verification-2025-10-16/              # 10/16の結果
│   ├── verification-2025-10-17/              # 10/17の結果
│   └── verification-comprehensive-report.md  # 統合レポート
└── .env.local                                # 環境変数（LINE設定含む）
```

---

## 📞 サポート

### トラブルシューティング

| 問題 | 原因 | 解決方法 |
|------|------|---------|
| LINE通知が届かない | トークン設定エラー | `npm run test:line` で接続確認 |
| 取引が実行されない | 設定が無効化されている | `trading.enabled: true` を確認 |
| システムが起動しない | 依存関係の問題 | `npm install` を再実行 |

### 問い合わせ先

- GitHub Issues: [daytrading-app/issues](https://github.com/PheasantDevil/daytrading-app/issues)
- ドキュメント: `./docs/`

---

**最終更新**: 2025年10月13日  
**バージョン**: 1.0.0

